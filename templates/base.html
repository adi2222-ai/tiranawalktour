<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Albania Walk Tour - Discover Albania's Capital{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="{{ url_for('index') }}" class="nav-logo">Albania Walk Tour</a>
            <div class="nav-menu" id="nav-menu">
                <a href="{{ url_for('index') }}" class="nav-link">Home</a>
                <a href="{{ url_for('about') }}" class="nav-link">About</a>
                <a href="#tours" class="nav-link">Tours</a>
                <a href="#contact" class="nav-link">Contact</a>
                
            </div>
            <div class="hamburger" id="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <h3>Albania Walk Tour</h3>
                <p>Discover the beauty and history of Albania's vibrant capital with our expert local guides.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <a href="{{ url_for('index') }}">Home</a>
                <a href="{{ url_for('about') }}">About</a>
                <a href="#tours">Tours</a>
            </div>
            <div class="footer-section">
                <h4>Contact Info</h4>
                <p>Email: info@albaniawalktour.com</p>
                <p>Phone: +355 69 123 4567</p>
                <p>Location: Tirana, Albania</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Albania Walk Tour. All rights reserved.</p>
        </div>
    </footer>


    <!-- Floating Contact Icons -->
    <div class="floating-contacts">
        <div class="translate-container">
            <div class="contact-icon translate" id="translate-toggle" onclick="toggleTranslateOptions()">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/>
                </svg>
            </div>
            <div class="translate-dropdown" id="translate-dropdown" style="display: none;">
                <a href="#" onclick="goToOriginal(event)" class="translate-option original">
                    <span class="flag">ğŸ‡ºğŸ‡¸</span> English (Original)
                </a>
                <a href="#" onclick="translatePage(event, 'de')" class="translate-option">
                    <span class="flag">ğŸ‡©ğŸ‡ª</span> Deutsch
                </a>
                <a href="#" onclick="translatePage(event, 'it')" class="translate-option">
                    <span class="flag">ğŸ‡®ğŸ‡¹</span> Italiano
                </a>
                <a href="#" onclick="translatePage(event, 'es')" class="translate-option">
                    <span class="flag">ğŸ‡ªğŸ‡¸</span> EspaÃ±ol
                </a>
                <a href="#" onclick="translatePage(event, 'fr')" class="translate-option">
                    <span class="flag">ğŸ‡«ğŸ‡·</span> FranÃ§ais
                </a>
                <a href="#" onclick="translatePage(event, 'ar')" class="translate-option">
                    <span class="flag">ğŸ‡¸ğŸ‡¦</span> Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
                </a>
                <a href="#" onclick="translatePage(event, 'zh')" class="translate-option">
                    <span class="flag">ğŸ‡¨ğŸ‡³</span> ä¸­æ–‡
                </a>
                <a href="#" onclick="translatePage(event, 'ru')" class="translate-option">
                    <span class="flag">ğŸ‡·ğŸ‡º</span> Ğ ÑƒÑÑĞºĞ¸Ğ¹
                </a>
            </div>
        </div>
        <div class="ai-assistant-container">
            <div class="contact-icon ai-assistant" id="ai-assistant-toggle" onclick="toggleAIAssistant()">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1L13.5 2.5L14.17 3.17L8.83 8.51L7.39 7.07L6 8.46L10.59 13.05L15.93 7.71L16.6 8.38L18 7L17 6L21 9ZM12.5 8C13.03 8 13.5 8.47 13.5 9S13.03 10 12.5 10 11.5 9.53 11.5 9 11.97 8 12.5 8ZM9.5 11C10.03 11 10.5 11.47 10.5 12S10.03 13 9.5 13 8.5 12.53 8.5 12 8.97 11 9.5 11ZM14.5 14C15.03 14 15.5 14.47 15.5 15S15.03 16 14.5 16 13.5 15.53 13.5 15 13.97 14 14.5 14ZM19 13C20.1 13 21 13.9 21 15S20.1 17 19 17 17 16.1 17 15 17.9 13 19 13ZM5 13C6.1 13 7 13.9 7 15S6.1 17 5 17 3 16.1 3 15 3.9 13 5 13ZM12 20C13.1 20 14 20.9 14 22C14 23.1 13.1 24 12 24C10.9 24 10 23.1 10 22C10 20.9 10.9 20 12 20Z"/>
                </svg>
            </div>
            <div class="ai-assistant-panel" id="ai-assistant-panel" style="display: none;">
                <div class="ai-header">
                    <h3>ğŸ¤– AI Trip Assistant</h3>
                    <p>Find your perfect Albanian adventure!</p>
                </div>
                <div class="ai-chat-container" id="ai-chat-container">
                    <div class="ai-message assistant" id="ai-welcome-message">
                        Hello! I'm your AI trip assistant. Tell me what kind of experience you're looking for in Albania and I'll recommend the perfect tours for you! 
                        <br><br>
                        For example: "I want a 1-day cultural tour" or "Looking for adventure activities" or "Historical sites for a week-long trip"
                    </div>
                </div>
                <div class="ai-input-container">
                    <input type="text" id="ai-input" placeholder="Describe your ideal Albanian trip..." onkeypress="handleAIKeyPress(event)">
                    <button onclick="sendAIMessage()" class="ai-send-btn">Send</button>
                </div>
            </div>
        </div>
        <a href="https://wa.me/+35569123456" class="contact-icon whatsapp" target="_blank">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
            </svg>
        </a>
        <a href="mailto:info@albaniawalktour.com" class="contact-icon email">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-.904.732-1.636 1.636-1.636h3.819v.273L12 8.82l6.545-4.726v-.273h3.819c.904 0 1.636.732 1.636 1.636Z"/>
            </svg>
        </a>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script>
        function toggleTranslateOptions() {
            const dropdown = document.getElementById('translate-dropdown');
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
            }
        }

        function getOriginalUrl() {
            // Always return the current page URL, removing any Google Translate parameters
            let url = window.location.href;
            
            // If we're on a translated page, extract the original URL
            if (url.includes('translate.google.com')) {
                // Try to extract the original URL from Google Translate
                const match = url.match(/[?&]u=([^&]+)/);
                if (match) {
                    return decodeURIComponent(match[1]);
                }
            }
            
            return url;
        }

        function translatePage(event, targetLang) {
            event.preventDefault();
            
            // Close the dropdown
            const dropdown = document.getElementById('translate-dropdown');
            if (dropdown) {
                dropdown.style.display = 'none';
            }
            
            // Get the current page URL (clean version)
            let originalUrl = getOriginalUrl();
            
            // Make sure we have a clean URL without Google Translate artifacts
            if (originalUrl.includes('translate.google.com') || originalUrl.includes('_x_tr_')) {
                originalUrl = window.location.origin + window.location.pathname;
            }
            
            // Create translation URL
            const translateUrl = `https://translate.google.com/translate?sl=auto&tl=${targetLang}&u=${encodeURIComponent(originalUrl)}`;
            
            // Navigate to translation
            window.location.href = translateUrl;
        }

        function goToOriginal(event) {
            event.preventDefault();
            
            // Close the dropdown
            const dropdown = document.getElementById('translate-dropdown');
            if (dropdown) {
                dropdown.style.display = 'none';
            }
            
            // Get clean original URL
            let originalUrl = getOriginalUrl();
            
            // If still on translate.google.com, go to site root
            if (originalUrl.includes('translate.google.com')) {
                originalUrl = window.location.origin;
            }
            
            // Navigate to original URL
            window.location.href = originalUrl;
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const translateToggle = document.getElementById('translate-toggle');
            const translateDropdown = document.getElementById('translate-dropdown');
            
            if (translateToggle && translateDropdown && 
                !translateToggle.contains(event.target) && 
                !translateDropdown.contains(event.target)) {
                translateDropdown.style.display = 'none';
            }
        });

        // Add keyboard support
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const dropdown = document.getElementById('translate-dropdown');
                const aiPanel = document.getElementById('ai-assistant-panel');
                if (dropdown && dropdown.style.display === 'block') {
                    dropdown.style.display = 'none';
                }
                if (aiPanel && aiPanel.style.display === 'block') {
                    aiPanel.style.display = 'none';
                }
            }
        });

        

        // AI Assistant functionality
        function toggleAIAssistant() {
            const panel = document.getElementById('ai-assistant-panel');
            if (panel) {
                panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                // Update welcome message language when opening
                if (panel.style.display === 'block') {
                    updateWelcomeMessage();
                }
            }
        }

        function updateWelcomeMessage() {
            const currentLang = detectPageLanguage();
            const welcomeMessage = document.getElementById('ai-welcome-message');
            
            const welcomeTexts = {
                'ar': 'Ù…Ø±Ø­Ø¨Ø§! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø°ÙƒÙŠ. Ø£Ø®Ø¨Ø±Ù†ÙŠ Ø¹Ù† Ù†ÙˆØ¹ Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„ØªÙŠ ØªØ¨Ø­Ø« Ø¹Ù†Ù‡Ø§ ÙÙŠ Ø£Ù„Ø¨Ø§Ù†ÙŠØ§ ÙˆØ³Ø£ÙˆØµÙŠ Ù„Ùƒ Ø¨Ø§Ù„Ø¬ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©!<br><br>Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„: "Ø£Ø±ÙŠØ¯ Ø¬ÙˆÙ„Ø© Ø«Ù‚Ø§ÙÙŠØ© Ù„ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯" Ø£Ùˆ "Ø£Ø¨Ø­Ø« Ø¹Ù† Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©" Ø£Ùˆ "Ù…ÙˆØ§Ù‚Ø¹ ØªØ§Ø±ÙŠØ®ÙŠØ© Ù„Ø±Ø­Ù„Ø© Ø£Ø³Ø¨ÙˆØ¹"',
                'es': 'Â¡Hola! Soy tu asistente de viajes con IA. Â¡Dime quÃ© tipo de experiencia buscas en Albania y te recomendarÃ© los tours perfectos!<br><br>Por ejemplo: "Quiero un tour cultural de 1 dÃ­a" o "Busco actividades de aventura" o "Sitios histÃ³ricos para un viaje de una semana"',
                'fr': 'Bonjour! Je suis votre assistant de voyage IA. Dites-moi quel type d\'expÃ©rience vous recherchez en Albanie et je vous recommanderai les visites parfaites!<br><br>Par exemple: "Je veux une visite culturelle d\'1 jour" ou "Je cherche des activitÃ©s d\'aventure" ou "Sites historiques pour un voyage d\'une semaine"',
                'de': 'Hallo! Ich bin Ihr KI-Reiseassistent. Sagen Sie mir, welche Art von Erlebnis Sie in Albanien suchen, und ich empfehle Ihnen die perfekten Touren!<br><br>Zum Beispiel: "Ich mÃ¶chte eine 1-tÃ¤gige Kulturtour" oder "Suche AbenteueraktivitÃ¤ten" oder "Historische StÃ¤tten fÃ¼r eine einwÃ¶chige Reise"',
                'it': 'Ciao! Sono il tuo assistente di viaggio AI. Dimmi che tipo di esperienza stai cercando in Albania e ti consiglierÃ² i tour perfetti!<br><br>Ad esempio: "Voglio un tour culturale di 1 giorno" o "Cerco attivitÃ  avventurose" o "Siti storici per un viaggio di una settimana"',
                'zh': 'ä½ å¥½ï¼æˆ‘æ˜¯æ‚¨çš„AIæ—…è¡ŒåŠ©æ‰‹ã€‚å‘Šè¯‰æˆ‘æ‚¨åœ¨é˜¿å°”å·´å°¼äºšå¯»æ‰¾ä»€ä¹ˆæ ·çš„ä½“éªŒï¼Œæˆ‘ä¼šä¸ºæ‚¨æ¨èå®Œç¾çš„æ—…æ¸¸ï¼<br><br>ä¾‹å¦‚ï¼š"æˆ‘æƒ³è¦1å¤©çš„æ–‡åŒ–ä¹‹æ—…"æˆ–"å¯»æ‰¾å†’é™©æ´»åŠ¨"æˆ–"ä¸€å‘¨æ—…è¡Œçš„å†å²æ™¯ç‚¹"',
                'ru': 'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚! Ğ¯ Ğ²Ğ°Ñˆ Ğ˜Ğ˜-Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸Ğº Ğ¿Ğ¾ Ğ¿ÑƒÑ‚ĞµÑˆĞµÑÑ‚Ğ²Ğ¸ÑĞ¼. Ğ¡ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ Ğ¼Ğ½Ğµ, ĞºĞ°ĞºĞ¾Ğ¹ Ğ¾Ğ¿Ñ‹Ñ‚ Ğ²Ñ‹ Ğ¸Ñ‰ĞµÑ‚Ğµ Ğ² ĞĞ»Ğ±Ğ°Ğ½Ğ¸Ğ¸, Ğ¸ Ñ Ğ¿Ğ¾Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒÑ Ğ²Ğ°Ğ¼ Ğ¸Ğ´ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚ÑƒÑ€Ñ‹!<br><br>ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: "Ğ¥Ğ¾Ñ‡Ñƒ Ğ¾Ğ´Ğ½Ğ¾Ğ´Ğ½ĞµĞ²Ğ½Ñ‹Ğ¹ ĞºÑƒĞ»ÑŒÑ‚ÑƒÑ€Ğ½Ñ‹Ğ¹ Ñ‚ÑƒÑ€" Ğ¸Ğ»Ğ¸ "Ğ˜Ñ‰Ñƒ Ğ¿Ñ€Ğ¸ĞºĞ»ÑÑ‡ĞµĞ½Ñ‡ĞµÑĞºĞ¸Ğµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸" Ğ¸Ğ»Ğ¸ "Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¼ĞµÑÑ‚Ğ° Ğ´Ğ»Ñ Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ¸"',
                'en': 'Hello! I\'m your AI trip assistant. Tell me what kind of experience you\'re looking for in Albania and I\'ll recommend the perfect tours for you!<br><br>For example: "I want a 1-day cultural tour" or "Looking for adventure activities" or "Historical sites for a week-long trip"'
            };
            
            if (welcomeMessage && welcomeTexts[currentLang]) {
                welcomeMessage.innerHTML = welcomeTexts[currentLang];
            }
        }

        function handleAIKeyPress(event) {
            if (event.key === 'Enter') {
                sendAIMessage();
            }
        }

        function sendAIMessage() {
            const input = document.getElementById('ai-input');
            const chatContainer = document.getElementById('ai-chat-container');
            const message = input.value.trim();
            
            if (!message) return;

            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'ai-message user';
            userMessage.textContent = message;
            chatContainer.appendChild(userMessage);

            // Clear input
            input.value = '';

            // Add typing indicator
            const typingMessage = document.createElement('div');
            typingMessage.className = 'ai-message assistant';
            typingMessage.innerHTML = 'Thinking... ğŸ¤”';
            chatContainer.appendChild(typingMessage);

            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // Simulate AI response
            setTimeout(() => {
                chatContainer.removeChild(typingMessage);
                const aiResponse = generateAIResponse(message.toLowerCase());
                const assistantMessage = document.createElement('div');
                assistantMessage.className = 'ai-message assistant';
                assistantMessage.innerHTML = aiResponse;
                chatContainer.appendChild(assistantMessage);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 1500);
        }

        function detectPageLanguage() {
            // Check if we're on a translated Google page
            const currentUrl = window.location.href;
            
            if (currentUrl.includes('translate.google.com')) {
                // Extract target language from Google Translate URL
                const match = currentUrl.match(/[?&]tl=([^&]+)/);
                if (match) {
                    return match[1];
                }
            }
            
            // Check document language
            if (document.documentElement.lang && document.documentElement.lang !== 'en') {
                return document.documentElement.lang;
            }
            
            // Check for translated content indicators
            const body = document.body.textContent.toLowerCase();
            if (body.includes('Ù…Ø±Ø­Ø¨Ø§') || body.includes('Ø§Ù„Ø³ÙŠØ§Ø­Ø©') || body.includes('Ø¬ÙˆÙ„Ø©')) return 'ar';
            if (body.includes('hola') || body.includes('turismo') || body.includes('recorrido')) return 'es';
            if (body.includes('bonjour') || body.includes('tourisme') || body.includes('visite')) return 'fr';
            if (body.includes('hallo') || body.includes('tourismus') || body.includes('rundgang')) return 'de';
            if (body.includes('ciao') || body.includes('turismo') || body.includes('giro')) return 'it';
            if (body.includes('ä½ å¥½') || body.includes('æ—…æ¸¸') || body.includes('å‚è§‚')) return 'zh';
            if (body.includes('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚') || body.includes('Ñ‚ÑƒÑ€Ğ¸Ğ·Ğ¼') || body.includes('ÑĞºÑĞºÑƒÑ€ÑĞ¸Ñ')) return 'ru';
            
            return 'en'; // Default to English
        }

        function getLocalizedText(lang, key) {
            const translations = {
                'ar': {
                    'recommendation_intro': 'Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ÙƒØŒ Ø£ÙˆØµÙŠ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª:',
                    'more_recommendations': 'Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙˆØµÙŠØ§Øª Ø£ÙƒØ«Ø± ØªØ­Ø¯ÙŠØ¯Ø§Ù‹ØŸ Ø¬Ø±Ø¨ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ù†: "Ø¬ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©"ØŒ "Ø§Ù„ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ø«Ù‚Ø§ÙÙŠØ©"ØŒ "Ø¬ÙˆÙ„Ø§Øª Ø§Ù„Ø·Ø¹Ø§Ù…"ØŒ Ø£Ùˆ "Ø±Ø­Ù„Ø§Øª Ø£Ø³Ø¨ÙˆØ¹ ÙƒØ§Ù…Ù„"!',
                    'view_details': 'Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„'
                },
                'es': {
                    'recommendation_intro': 'Basado en tu solicitud, recomiendo estos tours:',
                    'more_recommendations': 'Â¿Te gustarÃ­a recomendaciones mÃ¡s especÃ­ficas? Pregunta sobre: "tours de aventura", "experiencias culturales", "tours gastronÃ³micos", o "viajes de una semana"!',
                    'view_details': 'Ver detalles'
                },
                'fr': {
                    'recommendation_intro': 'BasÃ© sur votre demande, je recommande ces visites:',
                    'more_recommendations': 'Voulez-vous des recommandations plus spÃ©cifiques? Demandez Ã  propos de: "tours d\'aventure", "expÃ©riences culturelles", "tours gastronomiques", ou "voyages d\'une semaine"!',
                    'view_details': 'Voir dÃ©tails'
                },
                'de': {
                    'recommendation_intro': 'Basierend auf Ihrer Anfrage empfehle ich diese Touren:',
                    'more_recommendations': 'MÃ¶chten Sie spezifischere Empfehlungen? Fragen Sie nach: "Abenteuertouren", "Kulturerlebnisse", "Kulinarische Touren", oder "Wochenreisen"!',
                    'view_details': 'Details anzeigen'
                },
                'it': {
                    'recommendation_intro': 'Basato sulla tua richiesta, raccomando questi tour:',
                    'more_recommendations': 'Vuoi raccomandazioni piÃ¹ specifiche? Chiedi di: "tour avventura", "esperienze culturali", "tour gastronomici", o "viaggi di una settimana"!',
                    'view_details': 'Vedi dettagli'
                },
                'zh': {
                    'recommendation_intro': 'æ ¹æ®æ‚¨çš„è¦æ±‚ï¼Œæˆ‘æ¨èè¿™äº›æ—…æ¸¸:',
                    'more_recommendations': 'æƒ³è¦æ›´å…·ä½“çš„å»ºè®®å—ï¼Ÿè¯¢é—®ï¼š"å†’é™©æ—…æ¸¸"ã€"æ–‡åŒ–ä½“éªŒ"ã€"ç¾é£Ÿæ—…æ¸¸"æˆ–"ä¸€å‘¨æ—…è¡Œ"ï¼',
                    'view_details': 'æŸ¥çœ‹è¯¦æƒ…'
                },
                'ru': {
                    'recommendation_intro': 'ĞĞ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒÑ ÑÑ‚Ğ¸ Ñ‚ÑƒÑ€Ñ‹:',
                    'more_recommendations': 'Ğ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ±Ğ¾Ğ»ĞµĞµ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸? Ğ¡Ğ¿Ñ€Ğ¾ÑĞ¸Ñ‚Ğµ Ğ¾: "Ğ¿Ñ€Ğ¸ĞºĞ»ÑÑ‡ĞµĞ½Ñ‡ĞµÑĞºĞ¸Ğµ Ñ‚ÑƒÑ€Ñ‹", "ĞºÑƒĞ»ÑŒÑ‚ÑƒÑ€Ğ½Ñ‹Ğµ Ğ²Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ»ĞµĞ½Ğ¸Ñ", "Ğ³Ğ°ÑÑ‚Ñ€Ğ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ‚ÑƒÑ€Ñ‹", Ğ¸Ğ»Ğ¸ "Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ¸"!',
                    'view_details': 'ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾ÑÑ‚Ğ¸'
                },
                'en': {
                    'recommendation_intro': 'Based on your request, I recommend these tours:',
                    'more_recommendations': 'Would you like more specific recommendations? Try asking about: "adventure tours", "cultural experiences", "food tours", or "week-long trips"!',
                    'view_details': 'View Details'
                }
            };

            return translations[lang] && translations[lang][key] ? translations[lang][key] : translations['en'][key];
        }

        function generateAIResponse(message) {
            const currentLang = detectPageLanguage();
            
            const tours = [
                {
                    id: 'classic-tirana-tour',
                    title: 'Classic Tirana Walking Tour',
                    price: 35,
                    duration: '3 hours',
                    description: 'Perfect introduction to Tirana with major landmarks and history'
                },
                {
                    id: 'dajti-mountain-tour',
                    title: 'Dajti Mountain Adventure',
                    price: 65,
                    duration: 'Full Day',
                    description: 'Cable car ride and mountain hiking with stunning views'
                },
                {
                    id: 'food-culture-tour',
                    title: 'Food & Culture Experience',
                    price: 55,
                    duration: '4 hours',
                    description: 'Taste authentic Albanian cuisine and learn about local culture'
                },
                {
                    id: 'albania-week-tour',
                    title: 'Albania Highlights Week Tour',
                    price: 899,
                    duration: '6 days',
                    description: 'Complete Albanian experience from Tirana to the coast'
                }
            ];

            let recommendations = [];

            // Multi-language keyword matching
            const keywords = {
                day: ['day', 'dÃ­a', 'jour', 'tag', 'giorno', 'å¤©', 'Ğ´ĞµĞ½ÑŒ', 'ÙŠÙˆÙ…'],
                quick: ['quick', 'rÃ¡pido', 'rapide', 'schnell', 'veloce', 'å¿«é€Ÿ', 'Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹', 'Ø³Ø±ÙŠØ¹'],
                short: ['short', 'corto', 'court', 'kurz', 'breve', 'çŸ­', 'ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹', 'Ù‚ØµÙŠØ±'],
                adventure: ['adventure', 'aventura', 'aventure', 'abenteuer', 'avventura', 'å†’é™©', 'Ğ¿Ñ€Ğ¸ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ', 'Ù…ØºØ§Ù…Ø±Ø©'],
                mountain: ['mountain', 'montaÃ±a', 'montagne', 'berg', 'montagna', 'å±±', 'Ğ³Ğ¾Ñ€Ğ°', 'Ø¬Ø¨Ù„'],
                hiking: ['hiking', 'senderismo', 'randonnÃ©e', 'wandern', 'escursionismo', 'å¾’æ­¥', 'Ğ¿ĞµÑˆĞ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³ÑƒĞ»ĞºĞ¸', 'Ø§Ù„Ù…Ø´ÙŠ'],
                food: ['food', 'comida', 'nourriture', 'essen', 'cibo', 'é£Ÿç‰©', 'ĞµĞ´Ğ°', 'Ø·Ø¹Ø§Ù…'],
                cuisine: ['cuisine', 'cocina', 'cuisine', 'kÃ¼che', 'cucina', 'ç¾é£Ÿ', 'ĞºÑƒÑ…Ğ½Ñ', 'Ù…Ø·Ø¨Ø®'],
                eat: ['eat', 'comer', 'manger', 'essen', 'mangiare', 'åƒ', 'ĞµÑÑ‚ÑŒ', 'Ø£ÙƒÙ„'],
                week: ['week', 'semana', 'semaine', 'woche', 'settimana', 'å‘¨', 'Ğ½ĞµĞ´ĞµĞ»Ñ', 'Ø£Ø³Ø¨ÙˆØ¹'],
                long: ['long', 'largo', 'long', 'lang', 'lungo', 'é•¿', 'Ğ´Ğ»Ğ¸Ğ½Ğ½Ñ‹Ğ¹', 'Ø·ÙˆÙŠÙ„'],
                complete: ['complete', 'completo', 'complet', 'vollstÃ¤ndig', 'completo', 'å®Œæ•´', 'Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹', 'ÙƒØ§Ù…Ù„'],
                everything: ['everything', 'todo', 'tout', 'alles', 'tutto', 'ä¸€åˆ‡', 'Ğ²ÑÑ‘', 'ÙƒÙ„ Ø´ÙŠØ¡'],
                history: ['history', 'historia', 'histoire', 'geschichte', 'storia', 'å†å²', 'Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ', 'ØªØ§Ø±ÙŠØ®'],
                culture: ['culture', 'cultura', 'culture', 'kultur', 'cultura', 'æ–‡åŒ–', 'ĞºÑƒĞ»ÑŒÑ‚ÑƒÑ€Ğ°', 'Ø«Ù‚Ø§ÙØ©'],
                historical: ['historical', 'histÃ³rico', 'historique', 'historisch', 'storico', 'å†å²çš„', 'Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹', 'ØªØ§Ø±ÙŠØ®ÙŠ']
            };

            function containsKeywords(text, keywordArray) {
                return keywordArray.some(keyword => text.includes(keyword));
            }

            if (containsKeywords(message, keywords.day) || containsKeywords(message, keywords.quick) || containsKeywords(message, keywords.short)) {
                recommendations.push(tours[0], tours[2]);
            } else if (containsKeywords(message, keywords.adventure) || containsKeywords(message, keywords.mountain) || containsKeywords(message, keywords.hiking)) {
                recommendations.push(tours[1]);
            } else if (containsKeywords(message, keywords.food) || containsKeywords(message, keywords.cuisine) || containsKeywords(message, keywords.eat)) {
                recommendations.push(tours[2]);
            } else if (containsKeywords(message, keywords.week) || containsKeywords(message, keywords.long) || containsKeywords(message, keywords.complete) || containsKeywords(message, keywords.everything)) {
                recommendations.push(tours[3]);
            } else if (containsKeywords(message, keywords.history) || containsKeywords(message, keywords.culture) || containsKeywords(message, keywords.historical)) {
                recommendations.push(tours[0], tours[3]);
            } else {
                // Default recommendations
                recommendations.push(tours[0], tours[2]);
            }

            let response = getLocalizedText(currentLang, 'recommendation_intro') + '\n\n';
            
            recommendations.forEach(tour => {
                response += `<div class="tour-recommendation">
                    <h4>${tour.title}</h4>
                    <p><strong>â‚¬${tour.price}</strong> â€¢ ${tour.duration}</p>
                    <p>${tour.description}</p>
                    <a href="/tour/${tour.id}" class="tour-link">${getLocalizedText(currentLang, 'view_details')}</a>
                </div>`;
            });

            response += '\n\n' + getLocalizedText(currentLang, 'more_recommendations');

            return response;
        }

        // Close AI panel when clicking outside
        document.addEventListener('click', function(event) {
            const aiToggle = document.getElementById('ai-assistant-toggle');
            const aiPanel = document.getElementById('ai-assistant-panel');
            const translateToggle = document.getElementById('translate-toggle');
            const translateDropdown = document.getElementById('translate-dropdown');
            
            if (aiToggle && aiPanel && 
                !aiToggle.contains(event.target) && 
                !aiPanel.contains(event.target)) {
                aiPanel.style.display = 'none';
            }
            
            if (translateToggle && translateDropdown && 
                !translateToggle.contains(event.target) && 
                !translateDropdown.contains(event.target)) {
                translateDropdown.style.display = 'none';
            }
        });
    </script>
</body>
</html>